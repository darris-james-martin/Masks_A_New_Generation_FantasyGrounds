<?xml version="1.0" encoding="iso-8859-1"?>
<root>
  <windowclass name="influence_detail">
    <placement>
      <size height="30" width="393" />
    </placement>
    <sheetdata>
      <genericcontrol name="leftControl">
        <bounds>1,1,10,10</bounds>
      </genericcontrol>
      <genericcontrol name="rightControl">
        <bounds>-10,19,10,10</bounds>
      </genericcontrol>
      <genericcontrol name="ic_background">
        <anchored>
          <right anchor="left" parent="rightControl" offset="5" relation="relative" height="35" />
          <left anchor="left" parent="leftControl" offset="2" relation="relative" />
          <top anchor="top" parent="leftControl" offset="5" relation="relative" />
          <bottom anchor="bottom" parent="rightControl" offset="5" relation="relative" />
        </anchored>
        <backcolor>#FFA0A0A0</backcolor>
      </genericcontrol>
      <buttoncontrol name="btn_roll">
        <frame>
          <name>buttonup</name>
        </frame>
        <bounds>-75,10,40,20</bounds>
        <tooltip textres="influence_detail_btn_roll_Tooltip" />
        <state textres="influence_detail_btn_roll_ButtonCaption" />
        <stateframe>
          <pressed name="buttonup" offset="-1,-1,-1,-1" nobaseframe="true" />
        </stateframe>
        <font>button-white</font>
        <script>

function onClickRelease(button, x, y)
	

	local nodeChar = window.windowlist.window.getDatabaseNode();
    local nodeLink = window.link.getTargetDatabaseNode();
    local sDescription = window.str_description.getValue();
    local sName = window.name.getValue();
	
	
	local msg = 
	{
		font = "narratorfont", 
		mode = "ooc",
		icon = "portrait_" .. nodeChar.getName() .. "_chat";
		text = nodeChar.getChild("name").getValue()..Interface.getString("charsheet_use_influence").. sName;
	}
	
	msg.text = msg.text.."\n\nWhen you take advantage of your Influence over someone, surrender the Influence you hold over them to choose one:"..
		"\n- give them -2 on a move they just made (after the roll)"..
		"\n- inflict a condition on them"..
		"\n- take an additional +1 on a move targeting them (after the roll)"
	
	Comm.deliverChatMessage(msg);
end

</script>
      </buttoncontrol>
      <stringfield name="name">
        <anchored>
          <top anchor="bottom" parent="leftControl" offset="3" relation="relative" height="20" />
          <right anchor="left" parent="btn_roll" offset="-8" relation="relative" />
          <left anchor="left" parent="ic_background" offset="2" relation="relative" />
        </anchored>
        <lineoffset default="on">2</lineoffset>
      </stringfield>
      <linkfield name="link">
        <bounds>-28,11,20,20</bounds>
        <description>
          <field>name</field>
        </description>
        <class>influence_sheet</class>
      </linkfield>
      <stringfield name="str_description">
        <frame>
          <offset>7,5,7,5</offset>
        </frame>
        <bounds>414,5,22,10</bounds>
        <lineoffset default="on">2</lineoffset>
      </stringfield>
      <buttoncontrol name="btn_use">
        <frame>
          <name>buttonup</name>
        </frame>
        <bounds>-118,10,40,20</bounds>
        <state textres="influence_detail_btn_use_ButtonCaption" />
        <stateframe>
          <pressed name="buttonup" offset="-1,-1,-1,-1" nobaseframe="true" />
        </stateframe>
        <font>button-white</font>
        <script>

function onClickRelease(button, x, y)
	-- declarations
	local nodeChar = window.windowlist.window.getDatabaseNode();
    local nodeLink = window.link.getTargetDatabaseNode();
    local sDescription = window.str_description.getValue();
    local sName = window.name.getValue();
	    
    -- Crap Out
	if sDescription == "" then
		return;
	end
	
	ModifierStack.addSlot(sName, 1);
	
	local msg = 
	{
		font = "narratorfont", 
		mode = "ooc",
		icon = "portrait_" .. nodeChar.getName() .. "_chat";
		text = nodeChar.getChild("name").getValue()..Interface.getString("charsheet_use_influence").. sName;
	}
	Comm.deliverChatMessage(msg);
	
end

</script>
      </buttoncontrol>
    </sheetdata>
  </windowclass>
</root>